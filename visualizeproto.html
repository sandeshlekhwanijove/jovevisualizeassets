<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JoVE Visualize | The Visual Layer for Science</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Fonts: Inter (UI), Lora (Reading), JetBrains Mono (Data) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Lora:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            /* Brand Colors */
            --jove-brand: #2183ed;
            --jove-brand-dark: #1565c0;
            --jove-brand-light: #eff6ff; 
            
            /* Typography Colors */
            --text-main: #111827;     /* Almost Black */
            --text-body: #334155;     /* Dark Slate Gray */
            --text-meta: #64748b;     /* Muted Gray */
            
            /* Surfaces */
            --bg-page: #ffffff;
            --bg-figure: #f8fafc;
            --border: #e2e8f0;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-page);
            color: var(--text-body);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* --- UI COMPONENTS --- */
        .btn {
            display: inline-flex; align-items: center; justify-content: center;
            padding: 10px 24px; border-radius: 99px; /* Pill Shape */
            font-weight: 600; cursor: pointer;
            transition: all 0.2s; border: 1px solid transparent; font-size: 0.9rem;
        }
        .btn-primary { background: var(--jove-brand); color: white; }
        .btn-primary:hover { background: var(--jove-brand-dark); box-shadow: 0 4px 12px rgba(33, 131, 237, 0.25); }
        .btn-secondary { background: white; border-color: var(--border); color: var(--text-main); }
        .btn-secondary:hover { border-color: var(--jove-brand); color: var(--jove-brand); }
        .btn-pubmed { background: #002f6c; color: white; border-color: #002f6c; padding: 6px 16px; font-size: 0.8rem; }
        .btn-pubmed:hover { background: #001d4a; }

        /* --- HEADER --- */
        header {
            position: sticky; top: 0; z-index: 100;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid var(--border);
            padding: 12px 0;
            backdrop-filter: blur(12px);
        }

        .nav-content {
            max-width: 1200px; margin: 0 auto; padding: 0 20px;
            display: flex; justify-content: space-between; align-items: center;
        }

        .logo { 
            font-family: 'Inter', sans-serif; font-weight: 800; font-size: 1.2rem; 
            color: #0f172a; display: flex; align-items: center; gap: 8px; cursor: pointer;
        }
        .logo img { height: 24px; }

        .nav-links { display: flex; gap: 24px; font-size: 0.9rem; font-weight: 500; color: var(--text-meta); }
        .nav-links a { text-decoration: none; color: inherit; transition: color 0.2s; }
        .nav-links a:hover { color: var(--jove-brand); }

        /* --- HOMEPAGE (Search Mode) --- */
        #home-view {
            display: flex; flex-direction: column; align-items: center;
            padding-top: 80px; padding-bottom: 100px;
            background: radial-gradient(circle at 50% 0%, var(--jove-brand-light) 0%, white 70%);
        }

        .hero-section { text-align: center; max-width: 800px; padding: 0 20px; animation: fadeIn 0.8s ease; }
        
        .badge-new {
            background: #e0f2fe; color: var(--jove-brand); padding: 6px 14px; border-radius: 20px;
            font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;
            margin-bottom: 24px; display: inline-block;
        }

        .hero-title {
            font-size: 3.5rem; line-height: 1.1; font-weight: 800; color: var(--text-main); margin-bottom: 20px;
            letter-spacing: -0.02em; font-family: 'Inter', sans-serif;
        }
        .hero-title span { 
            background: linear-gradient(135deg, var(--jove-brand), #60a5fa);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .hero-subtitle {
            font-size: 1.25rem; color: var(--text-meta); margin-bottom: 50px; line-height: 1.6; max-width: 600px; margin-left: auto; margin-right: auto;
        }

        /* Ingest Box */
        .ingest-container {
            width: 100%; max-width: 700px;
            background: white; border: 1px solid var(--border);
            border-radius: 16px; overflow: hidden;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.08);
            display: flex; flex-direction: column;
        }

        .search-tabs { display: flex; border-bottom: 1px solid var(--border); background: #fcfcfc; }
        .tab-btn {
            flex: 1; padding: 16px; background: none; border: none; font-weight: 600; color: var(--text-meta);
            cursor: pointer; border-bottom: 2px solid transparent; font-size: 0.9rem; transition: all 0.2s;
        }
        .tab-btn.active { color: var(--jove-brand); border-bottom-color: var(--jove-brand); background: white; }

        .input-wrapper { padding: 20px; }
        .input-group { display: flex; gap: 10px; }
        
        .search-input {
            flex: 1; padding: 14px 20px; border: 1px solid var(--border); border-radius: 99px; /* Pill input */
            font-size: 1rem; outline: none; transition: border-color 0.2s; color: var(--text-main);
        }
        .search-input:focus { border-color: var(--jove-brand); box-shadow: 0 0 0 3px var(--jove-brand-light); }

        .upload-zone {
            padding: 40px; text-align: center; color: var(--text-meta);
            cursor: pointer; transition: all 0.2s; background: #f9fafb;
            border: 2px dashed var(--border); border-radius: 8px;
        }
        .upload-zone:hover { border-color: var(--jove-brand); background: var(--jove-brand-light); color: var(--jove-brand); }

        /* Paper Cards */
        .trend-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px; max-width: 1100px; margin-top: 80px; width: 100%; padding: 0 20px;
        }
        
        .paper-card {
            background: white; border: 1px solid var(--border); border-radius: 12px;
            padding: 24px; transition: all 0.2s; cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .paper-card:hover { transform: translateY(-3px); border-color: var(--jove-brand); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        
        .paper-tag { 
            font-size: 0.7rem; font-weight: 700; color: var(--jove-brand); 
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .paper-head { font-weight: 700; margin: 12px 0 8px 0; font-size: 1.1rem; line-height: 1.4; color: var(--text-main); font-family: 'Lora', serif; }
        .paper-meta { font-size: 0.85rem; color: var(--text-meta); display: flex; align-items: center; gap: 6px; }

        /* --- ARTICLE VIEW (The Core Experience) --- */
        #article-view { display: none; opacity: 0; transition: opacity 0.5s; background: white; }
        
        /* Layout Grid */
        .article-grid {
            display: grid;
            grid-template-columns: 1fr minmax(auto, 720px) 1fr;
            gap: 0 40px;
            max-width: 1200px; margin: 0 auto;
            padding-bottom: 100px;
        }

        .col-text { grid-column: 2; position: relative; } 
        .col-wide { grid-column: 1 / -1; max-width: 1000px; margin: 0 auto; width: 100%; padding: 0 20px; } 

        /* Header Block */
        .article-header-block {
            padding: 60px 0 20px 0;
            text-align: center;
            border-bottom: 1px solid var(--border);
            margin-bottom: 40px;
        }

        .journal-meta-row { display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 15px; }

        .journal-label { 
            font-family: 'Inter', sans-serif; font-size: 0.8rem; font-weight: 700; 
            color: var(--jove-brand); text-transform: uppercase; letter-spacing: 1px;
            display: inline-block; background: var(--jove-brand-light); padding: 6px 12px; border-radius: 20px;
        }

        h1 { 
            font-family: 'Lora', serif; font-size: 3rem; line-height: 1.2; 
            margin: 0 0 20px 0; color: var(--text-main); letter-spacing: -0.02em; 
        }

        .authors-line { font-family: 'Inter', sans-serif; font-size: 1rem; color: var(--text-meta); margin-bottom: 15px;}
        .affiliations { font-family: 'Inter', sans-serif; font-size: 0.85rem; color: var(--text-meta); font-style: italic; }

        /* Typography */
        h2 { 
            font-family: 'Inter', sans-serif; font-size: 1.6rem; color: var(--text-main); 
            margin-top: 60px; margin-bottom: 25px; font-weight: 700; letter-spacing: -0.01em;
            border-left: 4px solid var(--jove-brand); padding-left: 12px;
        }
        
        p, li { 
            font-family: 'Lora', serif; font-size: 1.15rem; line-height: 1.8; color: var(--text-body); 
            margin-bottom: 24px; 
        }

        ul { margin-bottom: 30px; padding-left: 20px; }

        /* Abstract Specific */
        .area-tags { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
        .area-tag {
            background: #f3f4f6; color: var(--text-meta); font-family: 'Inter', sans-serif;
            font-size: 0.75rem; font-weight: 600; padding: 6px 12px; border-radius: 4px;
            border: 1px solid var(--border);
        }

        /* "Visual Snippet" (Hover Preview) */
        .visual-snippet {
            color: var(--jove-brand);
            font-weight: 600;
            border-bottom: 2px dotted rgba(33, 131, 237, 0.4);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            white-space: nowrap;
            z-index: 20;
        }
        .visual-snippet:hover { 
            background: var(--jove-brand-light); 
            border-bottom-style: solid; 
            color: var(--jove-brand-dark);
        }
        .visual-snippet::after {
            content: '\f04b'; /* Play icon */
            font-family: 'Font Awesome 6 Free'; font-weight: 900;
            font-size: 0.6em; margin-left: 4px; vertical-align: middle;
            opacity: 0.6;
        }

        /* "Smart Link" / Video Citation (Full Video) */
        .vid-ref {
            display: inline-flex; align-items: center; gap: 4px;
            color: var(--jove-brand); font-family: 'Inter', sans-serif; font-size: 0.85rem; font-weight: 600;
            background: rgba(33, 131, 237, 0.08); padding: 2px 8px; border-radius: 4px;
            cursor: pointer; vertical-align: middle; transition: all 0.2s;
            border: 1px solid transparent; text-decoration: none; white-space: nowrap;
        }
        .vid-ref:hover { background: rgba(33, 131, 237, 0.15); border-color: rgba(33, 131, 237, 0.3); }
        .vid-ref i { font-size: 0.8em; }

        /* Text Block with Video Association */
        .has-video-ref { position: relative; }
        
        /* --- VISUAL COMPONENTS --- */
        
        /* 1. The Hero Visual Abstract */
        .hero-visual {
            background: #000; border-radius: 12px; overflow: hidden;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.15);
            margin-bottom: 60px; position: relative;
            aspect-ratio: 21/9; /* Cinematic */
            cursor: pointer;
        }
        .hero-thumb { width: 100%; height: 100%; object-fit: cover; opacity: 0.85; transition: opacity 0.3s; }
        .hero-visual:hover .hero-thumb { opacity: 0.6; }
        .play-big {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 80px; height: 80px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            border: 1px solid rgba(255,255,255,0.4); color: white; font-size: 2rem;
            transition: transform 0.2s;
        }
        .hero-visual:hover .play-big { transform: translate(-50%, -50%) scale(1.1); background: var(--jove-brand); border-color: var(--jove-brand); }

        /* 2. Inline Video Figure */
        .video-figure {
            margin: 50px auto 60px auto; max-width: 850px;
            background: white; border: 1px solid var(--border); border-radius: 12px;
            box-shadow: 0 4px 10px -2px rgba(0,0,0,0.05); overflow: hidden;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .video-figure.highlight-target {
            box-shadow: 0 0 0 2px var(--jove-brand), 0 15px 35px -5px rgba(33, 131, 237, 0.2);
            transform: scale(1.02);
        }
        .vf-stage { background: #f1f5f9; aspect-ratio: 16/9; position: relative; cursor: pointer; }
        .vf-play {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 60px; height: 60px; background: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: var(--jove-brand); font-size: 1.4rem; box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .vf-stage:hover .vf-play { transform: translate(-50%, -50%) scale(1.1); color: var(--jove-brand-dark); }
        .vf-brand-overlay {
            position: absolute; top: 15px; left: 15px;
            background: rgba(255,255,255,0.9); padding: 6px 12px; border-radius: 20px;
            display: flex; align-items: center; gap: 6px;
            font-family: 'Inter', sans-serif; font-weight: 700; font-size: 0.75rem; color: #0f172a;
            backdrop-filter: blur(4px);
        }
        .vf-brand-overlay img { height: 14px; }
        .vf-meta { padding: 20px 30px; background: #fcfcfc; border-top: 1px solid var(--border); display: flex; flex-direction: column; gap: 8px; }
        .vf-header { display: flex; justify-content: space-between; align-items: center; }
        .vf-label { font-family: 'Inter', sans-serif; font-weight: 700; font-size: 0.9rem; color: var(--text-main); white-space: nowrap; }
        .vf-caption { font-family: 'Inter', sans-serif; font-size: 0.95rem; color: var(--text-meta); line-height: 1.5; }

        /* SNIPPET TOOLTIP (Hover Player) */
        .snippet-tooltip {
            position: absolute;
            width: 320px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 50px -10px rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            z-index: 99999; /* Max Z-Index */
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.15s ease-out, transform 0.15s ease-out;
            top: 0; left: 0;
        }
        
        .snippet-tooltip.active {
            opacity: 1; pointer-events: auto;
        }

        .st-video-container {
            width: 100%; height: 180px;
            background: black;
            border-radius: 12px 12px 0 0;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .st-video-container iframe, .st-video-container video {
            width: 100%; height: 100%; object-fit: cover; border: none;
        }
        .st-video-container img { width: 100%; height: 100%; object-fit: cover; opacity: 0.9; }

        .st-play-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            display: flex; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.2); transition: opacity 0.2s; pointer-events: none;
        }
        .st-play-overlay i { font-size: 2rem; color: white; opacity: 0.8; }
        
        /* Hide play button when playing */
        .st-video-container.playing .st-play-overlay { opacity: 0; }

        .st-content {
            padding: 12px 16px;
        }
        .st-title { font-family: 'Inter', sans-serif; font-size: 0.9rem; font-weight: 700; color: var(--text-main); margin-bottom: 4px; line-height: 1.3;}
        .st-meta { font-size: 0.75rem; color: var(--text-meta); display: flex; justify-content: space-between; align-items: center; }
        .st-badge { background: var(--jove-brand-light); color: var(--jove-brand); padding: 2px 8px; border-radius: 4px; font-weight: 600; font-size: 0.7rem;}

        /* Floating Navigation Pill */
        .nav-pill {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(16px);
            border: 1px solid rgba(0,0,0,0.08); border-radius: 50px; padding: 6px;
            display: flex; gap: 4px; box-shadow: 0 20px 40px rgba(0,0,0,0.12), 0 5px 10px rgba(0,0,0,0.05);
            z-index: 900; transition: all 0.3s ease; opacity: 0; pointer-events: none; transform: translateX(-50%) translateY(20px);
        }
        .nav-pill.visible { opacity: 1; pointer-events: auto; transform: translateX(-50%) translateY(0); }
        .nav-pill-item {
            padding: 8px 16px; border-radius: 20px; cursor: pointer;
            font-family: 'Inter', sans-serif; font-size: 0.85rem; font-weight: 600; color: var(--text-meta);
            transition: all 0.2s; white-space: nowrap;
        }
        .nav-pill-item.active { background: var(--text-main); color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .nav-pill-item:hover:not(.active) { background: #f3f4f6; color: var(--text-main); }

        /* Author Info Toggle */
        .author-block { position: relative; display: inline-block; }
        
        .author-toggle {
            background: none; border: 1px solid var(--border); border-radius: 20px;
            padding: 6px 12px; color: var(--text-meta); font-size: 0.85rem; cursor: pointer;
            display: inline-flex; align-items: center; gap: 6px; transition: all 0.2s;
        }
        .author-toggle:hover { border-color: var(--text-main); color: var(--text-main); }

        .author-details {
            display: none; position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
            background: white; border: 1px solid var(--border); border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); padding: 15px; width: 300px;
            text-align: left; z-index: 50; margin-top: 10px;
        }
        .author-details.active { display: block; animation: fadeIn 0.2s ease; }
        .author-details p { font-family: 'Inter', sans-serif; font-size: 0.85rem; margin: 0 0 8px 0; color: var(--text-body); }
        .author-details i { color: var(--text-meta); margin-right: 6px; }

        .author-link { 
            color: var(--jove-brand); font-weight: 700; text-decoration: none; cursor: pointer;
        }
        .author-link:hover { text-decoration: underline; }

        /* Footer */
        footer {
            background: #f8fafc; border-top: 1px solid var(--border); padding: 80px 0 40px 0; font-family: 'Inter', sans-serif;
        }
        .footer-grid {
            max-width: 1200px; margin: 0 auto; padding: 0 20px;
            display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 40px;
        }
        .f-head { font-weight: 700; font-size: 0.85rem; color: var(--text-main); margin-bottom: 20px; }
        .f-link { display: block; color: var(--text-meta); text-decoration: none; margin-bottom: 12px; font-size: 0.9rem; }
        .f-link:hover { color: var(--jove-brand); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Tax Badges */
        .tax-badge {
            font-family: 'Inter', sans-serif; font-weight: 700; font-size: 0.75rem; 
            text-transform: uppercase; letter-spacing: 0.5px;
            padding: 4px 10px; border-radius: 4px; color: white; display: inline-block;
        }
        .tax-setup { background-color: #059669; }
        .tax-tactile { background-color: #d97706; }
        .tax-endpoint { background-color: #7c3aed; }

    </style>
</head>
<body>

    <!-- TOOLTIP CONTAINER -->
    <div id="snippet-tooltip" class="snippet-tooltip">
        <div class="st-video-container" id="st-container">
            <!-- Dynamic Content Injected Here -->
            <img id="st-img" src="" style="width:100%; height:100%; object-fit:cover;">
            <div class="st-play-overlay"><i class="fas fa-play"></i></div>
        </div>
        <div class="st-content">
            <div class="st-title" id="st-title">Topic Title</div>
            <div class="st-meta">
                <span class="st-badge">SNIPPET</span>
                <span id="st-time">0:15 Loop</span>
            </div>
        </div>
    </div>

    <header>
        <div class="nav-content">
            <div class="logo" onclick="goHome()">
                <img src="https://visualize.jove.com/wp-content/uploads/2025/06/jove-header.webp" alt="JoVE">
                VISUALIZE
            </div>
            <div class="nav-links">
                <a href="#">Browse</a>
                <a href="#">For Librarians</a>
                <a href="#">About</a>
            </div>
            <div class="nav-actions">
                <button class="btn btn-secondary" onclick="goHome()"><i class="fas fa-search"></i> &nbsp; Search</button>
            </div>
        </div>
    </header>

    <!-- === HOMEPAGE === -->
    <div id="home-view">
        <div class="hero-section">
            <span class="badge-new">New: Smart Method Mapping</span>
            <h1 class="hero-title">The Visual Layer for<br><span>Scientific Literature</span></h1>
            <p class="hero-subtitle">
                Paste any DOI or upload a PDF. We visualize the methods using JoVE's 18,000+ video library.
            </p>

            <div class="ingest-container">
                <div class="search-tabs">
                    <button class="tab-btn active" onclick="switchTab('search')">Find Paper</button>
                    <button class="tab-btn" onclick="switchTab('upload')">Upload PDF</button>
                </div>
                
                <div id="tab-search" class="input-wrapper">
                    <div class="input-group">
                        <input type="text" class="search-input" placeholder="Paste DOI, PubMed ID, or Keywords..." value="Cell Therapy Strategic Review">
                        <button class="btn btn-primary" onclick="loadAbstract()"><i class="fas fa-magic"></i> &nbsp; Visualize</button>
                    </div>
                </div>

                <div id="tab-upload" class="upload-zone" style="display:none;" onclick="loadFullPaper()">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p style="margin:0;"><strong>Click to Upload PDF</strong><br>or drag and drop here</p>
                </div>
            </div>
        </div>
    </div>

    <!-- === ARTICLE VIEW === -->
    <div id="article-view">
        
        <div class="article-grid">
            
            <!-- HEADER SECTION -->
            <div class="col-wide article-header-block">
                <div class="journal-meta-row">
                    <span class="journal-label" id="art-journal">Nature • Published May 14, 1998</span>
                    <a id="art-pubmed" href="https://pubmed.ncbi.nlm.nih.gov/9579857/" target="_blank" class="link-pubmed"><i class="fas fa-book-medical"></i> View on PubMed</a>
                </div>
                <h1 id="art-title">Cell Therapy</h1>
                
                <!-- Toggleable Author Details -->
                <div class="author-block">
                    <button class="author-toggle" onclick="toggleAuthors()">
                        <i class="fas fa-info-circle"></i> Author Information
                    </button>
                    <div id="author-details" class="author-details">
                        <p><i class="fas fa-user"></i> <strong id="auth-name">F H Gage</strong></p>
                        <p id="auth-affil"><i class="fas fa-building"></i> Laboratory of Genetics, The Salk Institute, La Jolla, California 92037, USA.</p>
                    </div>
                </div>
            </div>

            <!-- CONTENT AREA -->
            <div class="col-text">
                
                <!-- === STRUCTURED ABSTRACT CONTENT (Search View) === -->
                <div id="content-abstract">
                    <h2 id="sec-summary">Summary</h2>
                    <p class="abstract-text">Cell therapy offers a promising treatment for various diseases. The optimal cell type depends on the specific disease and its required function, addressing key challenges in <span class="visual-snippet" data-id="compatibility">immunological compatibility</span> and safety.</p>
                    
                    <div class="area-tags">
                        <span class="area-tag">Regenerative Medicine</span>
                        <span class="area-tag">Immunology</span>
                        <span class="area-tag">Biotechnology</span>
                    </div>

                    <!-- Visual Abstract Placement -->
                    <div class="col-wide video-figure" id="abs-visual-1" style="margin-left: -20px; margin-right: -20px;">
                        <div class="vf-stage">
                             <img class="figure-thumb" src="https://app.jove.com//_next/image?url=https://cloudfront.jove.com/files/media/science-education/science-education-thumbs/13475.jpg&w=828&q=75" style="width:100%; height:100%; object-fit:cover;">
                             <div class="vf-brand-overlay"><img src="https://visualize.jove.com/wp-content/uploads/2025/06/jove-header.webp"> Video</div>
                             <div class="vf-play"><i class="fas fa-play"></i></div>
                        </div>
                        <div class="vf-meta">
                            <div class="vf-header">
                                <div class="vf-label">Visual Abstract</div>
                            </div>
                            <div class="vf-caption">The Logic of Cell Therapy: An overview of cell selection and application.</div>
                        </div>
                    </div>

                    <h2 id="sec-background">Background</h2>
                    <p>
                        Cell therapy is a rapidly advancing field for treating human diseases. The effectiveness of cell therapy is highly dependent on the specific cell type and its intended function. Significant challenges remain, including immunological compatibility, <span class="visual-snippet" data-id="expansion">in vitro cell expansion</span>, and <span class="visual-snippet" data-id="qc">quality control</span>.
                    </p>

                    <!-- Abstract Video 1 -->
                    <div class="video-figure" id="fig1">
                        <div class="vf-stage">
                            <img class="figure-thumb" src="https://app.jove.com//_next/image?url=https://cloudfront.jove.com/CDNSource/teasers/68726.jpg&w=828&q=75" style="width:100%; height:100%; object-fit:cover;">
                            <div class="vf-brand-overlay"><img src="https://visualize.jove.com/wp-content/uploads/2025/06/jove-header.webp"> Video</div>
                            <div class="vf-play"><i class="fas fa-play"></i></div>
                        </div>
                        <div class="vf-meta">
                            <div class="vf-header">
                                <div class="vf-label">Related Video: Enhancing CAR-EV Technology</div>
                                <span class="tax-badge tax-setup">Methodology</span>
                            </div>
                            <div class="vf-caption">This protocol demonstrates engineering processes relevant to cell expansion challenges mentioned in the background.</div>
                        </div>
                    </div>

                    <h2 id="sec-purpose">Purpose Of The Study</h2>
                    <p>
                        To highlight the importance of cell source and function in tailoring cell therapy for specific diseases. To address the critical concerns hindering the widespread application of cell therapy. To emphasize the interdisciplinary approach required to overcome current limitations.
                    </p>

                    <h2 id="sec-methods">Main Methods</h2>
                    <ul>
                        <li>Review of current cell therapy strategies and challenges.</li>
                        <li>Analysis of factors influencing cell type selection for therapeutic applications.</li>
                        <li>Discussion of advancements in addressing immunological, manufacturing, and safety issues, particularly regarding <span class="vid-ref" data-target="fig2"><i class="fas fa-play-circle"></i> in vivo reprogramming</span>.</li>
                    </ul>

                    <!-- Abstract Video 2 -->
                    <div class="video-figure" id="fig2">
                        <div class="vf-stage">
                            <img class="figure-thumb" src="https://app.jove.com//_next/image?url=https://cloudfront.jove.com/CDNSource/teasers/68739.jpg&w=828&q=75" style="width:100%; height:100%; object-fit:cover;">
                            <div class="vf-brand-overlay"><img src="https://visualize.jove.com/wp-content/uploads/2025/06/jove-header.webp"> Video</div>
                            <div class="vf-play"><i class="fas fa-play"></i></div>
                        </div>
                        <div class="vf-meta">
                            <div class="vf-header">
                                <div class="vf-label">Related Video: Tractable In Vivo Reprogramming</div>
                                <span class="tax-badge tax-tactile">Technique</span>
                            </div>
                            <div class="vf-caption">Visualization of tumor cell injection techniques relevant to the methods discussion.</div>
                        </div>
                    </div>

                    <h2 id="sec-results">Main Results</h2>
                    <p>
                        No universal cell type is suitable for all diseases; source and function are critical determinants. Progress is being made in overcoming immunological barriers and improving in vitro cell multiplication. Quality control and safety measures are actively being developed through interdisciplinary collaboration.
                    </p>

                    <h2 id="sec-conclusions">Conclusions</h2>
                    <p>
                        Personalized cell selection based on disease requirements is essential for effective cell therapy. Interdisciplinary efforts are crucial for advancing cell therapy by addressing safety, efficacy, and scalability. Continued research and collaboration will pave the way for broader clinical applications, such as <span class="vid-ref" data-target="fig3"><i class="fas fa-play-circle"></i> non-viral engineering</span>.
                    </p>
                </div>

                <!-- === FULL PAPER CONTENT (Upload View - Dynamic Load) === -->
                <div id="content-full" style="display:none;">
                    <p><strong>Abstract:</strong> The study of the basic physiology of the neural precursors generated during brain development is driven by two inextricably linked goals. First, such knowledge is instrumental to our understanding of how the high degree of cellular complexity of the mature central nervous system (CNS) is generated...</p>

                    <h2 id="full-intro">Introduction</h2>
                    <p>
                        It is hoped that the isolation, propagation, and manipulation of brain precursors and, particularly, of multipotent <span class="visual-snippet" data-id="nsc">neural stem cells (NSCs)</span>, will lead to therapeutic applications in neurological disorders. The debate is still open concerning the most appropriate definition of a stem cell...
                    </p>

                    <!-- Full Fig 1 -->
                    <div class="video-figure" id="full-fig1">
                        <div class="vf-stage">
                            <img class="figure-thumb" src="https://app.jove.com//_next/image?url=https://cloudfront.jove.com/files/media/science-education/science-education-thumbs/10632.jpg&w=828&q=75" style="width:100%; height:100%; object-fit:cover;">
                            <div class="vf-brand-overlay"><img src="https://visualize.jove.com/wp-content/uploads/2025/06/jove-header.webp"> Video</div>
                            <div class="vf-play"><i class="fas fa-play"></i></div>
                        </div>
                        <div class="vf-meta">
                            <div class="vf-header">
                                <div class="vf-label">Video Figure 1: Neural Stem Cell Culture</div>
                                <span class="tax-badge tax-setup">Methods</span>
                            </div>
                            <div class="vf-caption">Visualizing the isolation and propagation techniques for NSCs discussed in the introduction.</div>
                        </div>
                    </div>

                    <h2 id="full-methods">Methods & Properties</h2>
                    <p>
                        We discuss recent evidence from our two groups that describe the isolation and propagation of clones of NSCs from the human fetal brain. Critical steps include the <span class="visual-snippet" data-id="dissociation">mechanical dissociation</span> of tissue and maintenance of specific growth factors.
                    </p>

                     <!-- Full Fig 2 -->
                    <div class="video-figure" id="full-fig2">
                        <div class="vf-stage">
                            <img class="figure-thumb" src="https://app.jove.com//_next/image?url=https://cloudfront.jove.com/CDNSource/teasers/2544.jpg&w=828&q=75" style="width:100%; height:100%; object-fit:cover;">
                            <div class="vf-brand-overlay"><img src="https://visualize.jove.com/wp-content/uploads/2025/06/jove-header.webp"> Video</div>
                            <div class="vf-play"><i class="fas fa-play"></i></div>
                        </div>
                        <div class="vf-meta">
                            <div class="vf-header">
                                <div class="vf-label">Video Figure 2: Neurosphere Assay</div>
                                <span class="tax-badge tax-tactile">Technique</span>
                            </div>
                            <div class="vf-caption">Demonstration of the neurosphere assay used to assess stem cell multipotency.</div>
                        </div>
                    </div>

                    <h2 id="full-results">Results & Discussion</h2>
                    <p>
                        These cells have begun to show promise for neural cell replacement and molecular support therapy in models of degenerative CNS diseases. The extensive propagation and engraftment potential may open novel strategies for untreatable CNS dysfunctions.
                    </p>
                </div>

            </div>
        </div>
    </div>

    <!-- FLOATING NAV PILL -->
    <div class="nav-pill" id="nav-pill">
        <!-- Items injected dynamically based on mode -->
    </div>

    <!-- === FOOTER === -->
    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <div class="f-head">ABOUT JoVE</div>
                <a href="#" class="f-link">Overview</a>
                <a href="#" class="f-link">Leadership</a>
                <a href="#" class="f-link">Blog</a>
            </div>
            <div class="footer-col">
                <div class="f-head">AUTHORS</div>
                <a href="#" class="f-link">Publishing</a>
                <a href="#" class="f-link">Editorial Board</a>
                <a href="#" class="f-link">Submit</a>
            </div>
            <div class="footer-col">
                <div class="f-head">LIBRARIANS</div>
                <a href="#" class="f-link">Subscriptions</a>
                <a href="#" class="f-link">Access</a>
                <a href="#" class="f-link">Resources</a>
            </div>
            <div class="footer-col">
                <div class="f-head">RESEARCH</div>
                <a href="#" class="f-link">JoVE Journal</a>
                <a href="#" class="f-link">Methods Collections</a>
            </div>
        </div>
        <div style="max-width:1200px; margin:40px auto 0; padding:0 20px; border-top:1px solid #e2e8f0; padding-top:20px; font-size:0.85rem; color:var(--text-meta); display:flex; justify-content:space-between;">
            <span>© 2025 JoVE. All rights reserved.</span>
            <span>Terms & Privacy</span>
        </div>
    </footer>

    <script>
        // --- SAFEGUARD HELPER ---
        function safeDisplay(id, displayValue) {
            const el = document.getElementById(id);
            if (el) el.style.display = displayValue;
        }

        // --- DATA OBJECTS FOR DYNAMIC LOADING ---
        const papers = {
            'search': {
                title: "Cell Therapy",
                authors: "F H Gage",
                affil: "Laboratory of Genetics, The Salk Institute, La Jolla, California 92037, USA.",
                journal: "Nature • Published May 14, 1998",
                link: "https://pubmed.ncbi.nlm.nih.gov/9579857/"
            },
            'upload': {
                title: "Establishment and properties of neural stem cell clones: plasticity in vitro and in vivo",
                authors: "A L Vescovi, E Y Snyder",
                affil: "Laboratory of Neuropharmacology, National Neurological Institute C. Besta, Milan, Italy.",
                journal: "Brain Pathol • Published Jul 1999",
                link: "https://pubmed.ncbi.nlm.nih.gov/10416994/"
            }
        };

        const snippetData = {
            'compatibility': { 
                title: "Immune Compatibility", 
                img: "https://img.youtube.com/vi/tTNXbRH334g/hqdefault.jpg",
                videoId: "tTNXbRH334g",
                start: "54",
                time: "0:12"
            },
            'expansion': { 
                title: "In Vitro Cell Expansion", 
                img: "https://app.jove.com//_next/image?url=https://cloudfront.jove.com/files/media/science-education/science-education-thumbs/13470.jpg&w=828&q=75",
                time: "0:30" 
            },
            'qc': { 
                title: "Quality Control Assays", 
                img: "https://app.jove.com//_next/image?url=https://cloudfront.jove.com/CDNSource/teasers/68726.jpg&w=828&q=75",
                time: "1:05" 
            },
            'dissociation': { 
                title: "Mechanical Dissociation", 
                img: "https://app.jove.com//_next/image?url=https://cloudfront.jove.com/CDNSource/teasers/68739.jpg&w=828&q=75",
                time: "0:45"
            },
            'enzymatic': { 
                title: "Enzymatic Digestion", 
                img: "https://app.jove.com//_next/image?url=https://cloudfront.jove.com/CDNSource/teasers/68150.jpg&w=828&q=75",
                time: "1:15"
            },
            'nsc': {
                title: "Neural Stem Cells",
                img: "https://app.jove.com//_next/image?url=https://cloudfront.jove.com/files/media/science-education/science-education-thumbs/10632.jpg&w=828&q=75",
                time: "0:20"
            }
        };

        // --- ROUTING LOGIC ---
        function loadAbstract() {
            showView('abstract'); 
        }

        function loadFullPaper() {
            showView('full');
        }

        function showView(type) {
            safeDisplay('home-view', 'none');
            const article = document.getElementById('article-view');
            const navPill = document.getElementById('nav-pill');
            
            // Update Header Data
            const data = (type === 'full') ? papers.upload : papers.search;
            document.getElementById('art-title').textContent = data.title;
            document.getElementById('auth-name').textContent = data.authors;
            document.getElementById('auth-affil').textContent = data.affil;
            document.getElementById('art-journal').textContent = data.journal;
            document.getElementById('art-pubmed').href = data.link;

            // Toggle Content
            const isFull = (type === 'full');
            safeDisplay('content-abstract', isFull ? 'none' : 'block');
            safeDisplay('content-full', isFull ? 'block' : 'none');
            
            // Update Nav Pill Content
            let navHTML = '';
            if(type === 'abstract') {
                navHTML = `
                    <div class="nav-pill-item" onclick="scrollToTop()">Summary</div>
                    <div class="nav-pill-item" onclick="scrollToSection('sec-background')">Background</div>
                    <div class="nav-pill-item" onclick="scrollToSection('sec-purpose')">Purpose</div>
                    <div class="nav-pill-item" onclick="scrollToSection('sec-methods')">Methods</div>
                    <div class="nav-pill-item" onclick="scrollToSection('sec-results')">Results</div>
                `;
            } else {
                navHTML = `
                    <div class="nav-pill-item" onclick="scrollToTop()">Abstract</div>
                    <div class="nav-pill-item" onclick="scrollToSection('full-intro')">Intro</div>
                    <div class="nav-pill-item" onclick="scrollToSection('full-methods')">Methods</div>
                    <div class="nav-pill-item" onclick="scrollToSection('full-results')">Results</div>
                `;
            }
            if(navPill) {
                navPill.innerHTML = navHTML;
            }

            if(article) {
                article.style.display = 'block';
                setTimeout(() => {
                    article.style.opacity = '1';
                    window.scrollTo(0, 0);
                }, 10);
            }
        }

        function goHome() {
            const article = document.getElementById('article-view');
            if(article) article.style.opacity = '0';
            
            setTimeout(() => {
                if(article) article.style.display = 'none';
                safeDisplay('home-view', 'flex');
                const navPill = document.getElementById('nav-pill');
                if(navPill) navPill.classList.remove('visible');
            }, 500);
        }

        function switchTab(mode) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if(event && event.target) event.target.classList.add('active');
            
            safeDisplay('tab-search', mode === 'search' ? 'flex' : 'none');
            safeDisplay('tab-upload', mode === 'upload' ? 'block' : 'none');
        }

        function toggleAuthors() {
            const details = document.getElementById('author-details');
            if(details) details.classList.toggle('active');
        }

        function scrollToSection(id) {
            const el = document.getElementById(id);
            if(el) {
                const headerOffset = 100;
                const elementPosition = el.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
            }
        }
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        function scrollToFigure(id) {
            const el = document.getElementById(id);
            if(el) {
                el.classList.add('highlight-target');
                setTimeout(() => el.classList.remove('highlight-target'), 2000);
                el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // --- Event Listeners for Correlations ---
        document.querySelectorAll('.vid-ref').forEach(link => {
            link.addEventListener('mouseenter', () => {
                const targetId = link.getAttribute('data-target');
                const target = document.getElementById(targetId);
                if(target) target.classList.add('highlight-target');
            });
            link.addEventListener('mouseleave', () => {
                const targetId = link.getAttribute('data-target');
                const target = document.getElementById(targetId);
                if(target) target.classList.remove('highlight-target');
            });
        });

        // 2. Visual Snippet Tooltips Logic with YouTube Support
        const tooltip = document.getElementById('snippet-tooltip');
        const stTitle = document.getElementById('st-title');
        const stTime = document.getElementById('st-time');
        const stVideoContainer = document.getElementById('st-container');
        const stImg = document.getElementById('st-img');

        let hideTimeout;

        function showTooltip(term) {
            clearTimeout(hideTimeout);
            const id = term.dataset.id;
            const data = snippetData[id];

            if(data){
                stTitle.innerText = data.title;
                stTime.innerText = data.time + " Loop";
                
                // Store video data on container
                stVideoContainer.dataset.videoId = data.videoId || '';
                stVideoContainer.dataset.start = data.start || '0';
                
                // Set Thumbnail
                stImg.src = data.img;
                stImg.style.display = 'block';
                stVideoContainer.innerHTML = `<img id="st-img" src="${data.img}" style="width:100%; height:100%; object-fit:cover;">
                                              <div class="st-play-overlay"><i class="fas fa-play"></i></div>`;

                // Show tooltip
                tooltip.classList.add('active');
                
                const rect = term.getBoundingClientRect();
                const topPos = rect.top + window.scrollY - 230; 
                const leftPos = rect.left + (rect.width/2);
                
                tooltip.style.top = topPos + 'px';
                tooltip.style.left = leftPos + 'px';
            }
        }

        function hideTooltip() {
            hideTimeout = setTimeout(() => {
                tooltip.classList.remove('active');
                // Reset content
                stVideoContainer.innerHTML = '';
            }, 300); // 300ms bridge delay
        }

        document.querySelectorAll('.visual-snippet').forEach(term => {
            term.addEventListener('mouseenter', () => showTooltip(term));
            term.addEventListener('mouseleave', () => hideTooltip());
        });

        // Tooltip Hover Interaction
        tooltip.addEventListener('mouseenter', () => clearTimeout(hideTimeout));
        tooltip.addEventListener('mouseleave', () => hideTooltip());

        // Video Interaction (YouTube Injection)
        if(stVideoContainer) {
            stVideoContainer.addEventListener('mouseenter', () => {
                const vidId = stVideoContainer.dataset.videoId;
                const start = stVideoContainer.dataset.start;
                
                if(vidId) {
                    stVideoContainer.innerHTML = `<iframe width="100%" height="100%" 
                        src="https://www.youtube.com/embed/${vidId}?start=${start}&autoplay=1&mute=1&controls=0&modestbranding=1&rel=0" 
                        frameborder="0" allow="autoplay; encrypted-media"></iframe>`;
                }
            });
            
            stVideoContainer.addEventListener('mouseleave', () => {
                // Revert to thumbnail on leave to stop video
                const vidId = stVideoContainer.dataset.videoId;
            });
        }

        // Scroll Spy
        window.addEventListener('scroll', () => {
            const navPill = document.getElementById('nav-pill');
            const articleView = document.getElementById('article-view');
            
            if(articleView && articleView.style.display !== 'none' && window.scrollY > 150) {
                if(navPill) navPill.classList.add('visible');
            } else {
                if(navPill) navPill.classList.remove('visible');
            }
        });
    </script>

</body>
</html>
